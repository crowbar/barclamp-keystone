#!/bin/bash

# Tenants
keystone-manage $* tenant add admin
keystone-manage $* tenant add demo

# Users
keystone-manage $* user add demo secrete demo
keystone-manage $* user add admin secrete admin

# Roles
keystone-manage $* role add Admin
keystone-manage $* role add Member
keystone-manage $* role grant Admin admin

# Tokens
keystone-manage $* token add 999888777666 admin admin 2015-02-05T00:00


#endpointTemplates
<% @swift_addrs.each do |n|  %>
keystone-manage $* endpointTemplates add RegionOne swift http://<%= n%>:8080/v1/AUTH_%tenant_id% http://<%= api_vip %>:8080/ http://<%= api_vip %>:8080/v1/AUTH_%tenant_id% 1 1
<% end unless @swift_addrs.nil? or @swift_addrs.empty? %>

<% @nova_addrs.each do |n|  %>
keystone-manage $* endpointTemplates add RegionOne nova_compat http://<%= n %>:8774/v1.0/ http://<%= n %>:8774/v1.0  http://<%= n %>:8774/v1.0 1 1
keystone-manage $* endpointTemplates add RegionOne nova http://<%= n %>:8774/v1.1/%tenant_id% http://<%= n %>:8774/v1.1/%tenant_id%  http://<%= n %>:8774/v1.1/%tenant_id% 1 1
<% end unless @nova_addrs.nil? or @nova_addrs.empty? %>

<% @glance_addrs.each do |n|  %>
keystone-manage $* endpointTemplates add RegionOne glance http://<%= n  %>:9292/v1.1/%tenant_id% http://<%= n  %>:9292/v1.1/%tenant_id% http://<%= n  %>:9292/v1.1/%tenant_id% 1 1
<% end unless @glance_addrs.nil? or @glance_addrs.empty? %>

keystone-manage $* endpointTemplates add RegionOne identity http://<%= @keystone_addr  %>:5000/v2.0 http://<%=  @keystone_addr  %>:5001/v2.0 http://<%=  @keystone_addr  %>:5000/v2.0 1 1


#Tenant endpoints
keystone-manage $* endpoint add admin 1
#keystone-manage $* endpoint add admin 2
#keystone-manage $* endpoint add admin 3
#keystone-manage $* endpoint add admin 4
#keystone-manage $* endpoint add admin 5
#keystone-manage $* endpoint add admin 6

keystone-manage $* endpoint add demo 1
#keystone-manage $* endpoint add demo 2
#keystone-manage $* endpoint add demo 3
#keystone-manage $* endpoint add demo 4
#keystone-manage $* endpoint add demo 5
#keystone-manage $* endpoint add demo 6
